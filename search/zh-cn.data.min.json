[{"id":0,"href":"/zh-cn/installation/windows/","title":"Windows系统安装指导","parent":"安装指导","content":"要使用图形安装向导执行安装，您必须具有超级用户或管理员权限。\n以下部分将引导您完成在 Windows 主机上安装 PostgreSQL 的过程。\n要启动安装向导，请确保有足够的权限，然后双击安装程序图标。如果出现提示，请提供密码。\n请注意，在某些版本的Windows中，要使用管理员权限调用安装程序，您需要右键单击安装程序图标，然后从上下文菜单中选择以管理员身份运行。\n将打开Redrock12 安装欢迎窗口，单击下一步继续。\n    图 1: Redrock 12 安装欢迎窗口    将打开选择安装位置窗口。接受默认安装目录，或者指定其他可用位置，然后单击下一步继续。\n    图 2: 选择安装位置对话框    单击下一步继续。\n将打开选择数据目录窗口。接受默认的数据存储位置，或者指定要其他可用位置用于存储数据文件。\n    图 3: 选择数据存储位置对话框    单击下一步继续。\n将打开服务器选项窗口。\n    图 4: 服务器选项对话框    PostgreSQL 使用端口字段来指定服务器应侦听的端口号。默认侦听器端口为5432。\n使用区域字段指定新数据库群集将使用的区域设置。默认是操作系统区域设置。\n使用管理员用户字段指定数据库管理员用户名称。默认管理员用户名是postgres。\n使用管理员密码字段指定数据库管理员密码。输入的密码应符合足够的复杂性。在管理员密码字段中输入密码，并在确认字段中确认密码后。\n单击下一步继续。\n    图 5: 调整配置参数对话框    调整配置参数对话框将指导您通过设置一些重要的配置参数来优化服务器性能。您可以让安装程序自动调整配置参数，然后单击下一步继续。\n    图 6: 选择开始菜单文件夹    在安装过程中，安装向导会通过一系列进度条确认PostgreSQL的安装进度。\n    图 7: 安装进度显示窗口    当出现安装程序结束窗口时，恭喜您！请单击完成以完成 PostgreSQL 安装。\n    图 8: 安装程序结束窗口    "},{"id":1,"href":"/zh-cn/usage/getting-started/","title":"开始上手","parent":"使用介绍","content":"   安装 架构基础 访问数据库 下一步是什么？      安装     自然，在你能开始使用PostgreSQL之前， 你必须安装它。PostgreSQL很有可能已经安装到你的节点上了， 因为它可能包含在你的操作系统的发布里， 或者是系统管理员已经安装了它。如果是这样的话， 那么你应该从操作系统的文档或者你的系统管理员那里获取有关如何访问PostgreSQL的信息。\n如果你不清楚PostgreSQL是否已经安装， 或者不知道你能否用它（已经安装的）做自己的实验，那么你就可以自己安装。 这么做并不难，并且是一次很好的练习。PostgreSQL可以由任何非特权用户安装， 并不需要超级用户 （root）的权限。\n如果你准备自己安装PostgreSQL， 那么请参考第 16 章以获取安装的有关信息， 安装之后再回到这个指导手册来。一定要记住要尽可能遵循有关设置合适的环境变量章节里的信息。\n如果你的站点管理员没有按照缺省的方式设置各项相关参数， 那你还有点额外的活儿要干。比如，如果数据库服务器机器是一个远程的机器， 那你就需要把PGHOST环境变量设置为数据库服务器的名字。环境变量PGPORT也可能需要设置。总而言之就是： 如果当你试着启动一个应用而该应用报告说不能与数据库建立联接时， 你应该马上与你的数据库管理员联系，如果你就是管理员， 那么你就要参考文档以确保你的环境变量得到正确的设置。 如果你不理解随后的几段，那么先阅读下一节。\n架构基础     在我们继续之前，你应该先了解PostgreSQL的系统架构。 对PostgreSQL的部件之间如何相互作用的理解将会使本节更易理解。\n在数据库术语里，PostgreSQL使用一种客户端/服务器的模型。一次PostgreSQL会话由下列相关的进程（程序）组成：\n 一个服务器进程，它管理数据库文件、接受来自客户端应用与数据库的联接并且代表客户端在数据库上执行操作。 该数据库服务器程序叫做postgres。 那些需要执行数据库操作的用户的客户端（前端）应用。 客户端应用可能本身就是多种多样的：可以是一个面向文本的工具， 也可以是一个图形界面的应用，或者是一个通过访问数据库来显示网页的网页服务器，或者是一个特制的数据库管理工具。 一些客户端应用是和 PostgreSQL发布一起提供的，但绝大部分是用户开发的。  和典型的客户端/服务器应用（C/S应用）一样，这些客户端和服务器可以在不同的主机上。 这时它们通过 TCP/IP 网络联接通讯。 你应该记住的是，在客户机上可以访问的文件未必能够在数据库服务器机器上访问（或者只能用不同的文件名进行访问）。\nPostgreSQL服务器可以处理来自客户端的多个并发请求。 因此，它为每个连接启动（“forks”）一个新的进程。 从这个时候开始，客户端和新服务器进程就不再经过最初的 postgres进程的干涉进行通讯。 因此，主服务器进程总是在运行并等待着客户端联接， 而客户端和相关联的服务器进程则是起起停停（当然，这些对用户是透明的。我们介绍这些主要是为了内容的完整性）。\n访问数据库     一旦你创建了数据库，你就可以通过以下方式访问它：\n 运行PostgreSQL的交互式终端程序，它被称为psql， 它允许你交互地输入、编辑和执行SQL命令。 使用一种已有的图形化前端工具，比如pgAdmin或者带ODBC或JDBC支持的办公套件来创建和管理数据库。这种方法在这份教程中没有介绍。 使用多种绑定发行的语言中的一种写一个自定义的应用。这些可能性在第 IV 部分中将有更深入的讨论。  你可能需要启动psql来试验本教程中的例子。 你可以用下面的命令为postgres数据库激活它：\n$ psql postgres 如果你不提供数据库名字，那么它的缺省值就是你的用户账号名字。\n在psql中，你将看到下面的欢迎信息：\npsql (12.1) Type \u0026#34;help\u0026#34; for help. postgres=\u0026gt; 最后一行也可能是：\npostgres=# 这个提示符意味着你是数据库超级用户，最可能出现在你自己安装了 PostgreSQL实例的情况下。 作为超级用户意味着你不受访问控制的限制。 对于本教程的目的而言， 是否超级用户并不重要。\npsql打印出的最后一行是提示符，它表示psql正听着你说话，这个时候你就可以敲入 SQL查询到一个psql维护的工作区中。试验一下下面的命令：\npostgres=\u0026gt; SELECT version(); version ------------------------------------------------------------------------------------------ PostgreSQL 12.1 on x86_64-pc-linux-gnu, compiled by gcc (Debian 4.9.2-10) 4.9.2, 64-bit (1 row) postgres=\u0026gt; SELECT current_date; date ------------ 2016-01-07 (1 row) postgres=\u0026gt; SELECT 2 + 2; ?column? ---------- 4 (1 row) psql程序有一些不属于SQL命令的内部命令。它们以反斜线开头，“\\”。 欢迎信息中列出了一些这种命令。比如，你可以用下面的命令获取各种PostgreSQL的SQL命令的帮助语法：\npostgres=\u0026gt; \\h 要退出psql，输入：\npostgres=\u0026gt; \\q psql将会退出并且让你返回到命令行shell。 （要获取更多有关内部命令的信息，你可以在psql提示符上键入\\?。） psql的完整功能在psql中有文档说明。在这份文档里，我们将不会明确使用这些特性，但是你自己可以在需要的时候使用它们。\n下一步是什么？     还有很多东西要发现。 要获取更多信息，请参阅 PostgreSQL 文档。\n"},{"id":2,"href":"/zh-cn/usage/","title":"使用介绍","parent":"欢迎访问红石数据库文档","content":""},{"id":3,"href":"/zh-cn/installation/","title":"安装指导","parent":"欢迎访问红石数据库文档","content":""},{"id":4,"href":"/zh-cn/installation/redhat/","title":"Red Hat系统安装指导","parent":"安装指导","content":"   安装 RPM 软件包 安装设置  数据目录 更改数据目录 初始化数据 设置开机启动   服务器控制 安装后配置调整      安装 RPM 软件包     下载 Red Hat Enterprise Linux 或 CentOS 的安装包，使用以下命令进行安装：\n# tar xf redrock-12.1-1.el8.x86_64-bundle.tar # cd redrock-12.1-1.el8.x86_64-bundle # rpm -ivh redrock-12.1-1.el8.x86_64.rpm redrock-libs-12.1-1.el8.x86_64.rpm redrock-server-12.1-1.el8.x86_64.rpm 您还可以根据您的需要安装其他软件包。\n安装设置     安装软件包后，需要初始化和配置数据库。\n在下面的命令中，的值表示 PostgreSQL 的主版本号，例如：12\n数据目录     PostgreSQL 数据目录包含数据库的所有数据文件。环境变量 PGDATA 用于指定数据目录路径。\n默认数据目录为：\n/var/lib/pgsql/\u0026lt;version\u0026gt;/data 例如：\n/var/lib/pgsql/12/data 更改数据目录     进入到自定义的挂载目录（例如：/u01），然后创建一个 postgres 用户为拥有者的文件夹 pgdata ：\n# cd /u01 # mkdir pgdata # chown postgres:postgres pgdata 然后，编辑 postgresql 服务：\n# systemctl edit postgresql-12.service 进入到自定义的数据目录，该目录应该具有主机中大部分的可用磁盘空间，复制该目录路径并粘贴到服务文件中：\n[Service] Environment=PGDATA=/u01/pgdata 初始化数据     执行类似如下的命令，在 PGDATA 中初始化数据库：\n$ /usr/pgsql-\u0026lt;version\u0026gt;/bin/postgresql-\u0026lt;version\u0026gt;-setup initdb 对于版本 12，请使用：\n$ /usr/pgsql-12/bin/postgresql-12-setup initdb 设置开机启动     如果您希望 PostgreSQL 在操作系统开机启动时自动运行，请执行以下操作：\n# systemctl enable postgresql-12.service 服务器控制     要控制数据库服务，请使用：\n# systemctl \u0026lt;command\u0026gt; postgresql-12.service 其中的  可以为:\n enable : 启用开机启动 start : 启动数据库 stop : 停止数据库 restart : 重启数据库; 主要用于重要参数的变更生效 reload : 在数据库运行过程中更新配置参数  例如，要控制版本 12 的数据库服务，请使用：\n# systemctl enable postgresql-12.service # systemctl start postgresql-12.service 安装后配置调整     修改数据目录下的 pg_hba.conf 文件，以定义从网络中其他主机访问 PostgreSQL 服务器使用的访问控制策略，修改IPv4网络访问控制策略：从 indent 更改为 md5，从本机地址 127.0.0.1 更改为接受所有主机访问请求。找到下面行：\n# IPv4 local connections: host all all 127.0.0.1/32 ident 并将其更改为：\n# IPv4 local connections: host all all 0.0.0.0/0 md5 修改数据目录下的 postgresql.conf 文件，通过取消注释以下参数行并设置参数值为 * 而不是 localhost 来允许来自所有主机的访问连接：\nlisten_addresses = \u0026#39;*\u0026#39; 重启数据库服务以更新配置参数：\n# systemctl restart postgresql-12.service 在生产环境中，还应设置 TLS 安全通信，并且应考虑配置数据复制或基于快照的备份。有关这些配置，请参阅 PostgreSQL 在线文档。\n"},{"id":5,"href":"/zh-cn/features/","title":"基础特性","parent":"欢迎访问红石数据库文档","content":""},{"id":6,"href":"/zh-cn/installation/debian/","title":"Debian系统安装指导","parent":"安装指导","content":"   安装 DEB 软件包 安装设置  数据目录 更改数据目录 初始化数据 设置开机启动   服务器控制 安装后配置调整      安装 DEB 软件包     下载 Debian 的安装包，使用以下命令进行安装：\n# tar xf redrock-12.1-1.debian11.amd64-bundle.tar # cd redrock-12.1-1.debian11.amd64-bundle # dpkg -i redrock-client_12.1-1_amd64.deb redrock_12.1-1_amd64.deb 您还可以根据您的需要安装其他软件包。\n安装设置     安装软件包后，需要初始化和配置数据库。\n在下面的命令中，的值表示 PostgreSQL 的主版本号，例如：12\n数据目录     PostgreSQL 数据目录包含数据库的所有数据文件。环境变量 PGDATA 用于指定数据目录路径。\n默认数据目录为：\n/var/lib/pgsql/\u0026lt;version\u0026gt;/data 例如：\n/var/lib/pgsql/12/data 更改数据目录     进入到自定义的挂载目录（例如：/u01），然后创建一个 postgres 用户为拥有者的文件夹 pgdata ：\n# cd /u01 # mkdir pgdata # chown postgres:postgres pgdata 然后，编辑 postgresql 服务：\n# systemctl edit postgresql-12.service 进入到自定义的数据目录，该目录应该具有主机中大部分的可用磁盘空间，复制该目录路径并粘贴到服务文件中：\n[Service] Environment=PGDATA=/u01/pgdata 初始化数据     执行类似如下的命令，在 PGDATA 中初始化数据库：\n$ /usr/pgsql-\u0026lt;version\u0026gt;/bin/postgresql-\u0026lt;version\u0026gt;-setup initdb 对于版本 12，请使用：\n$ /usr/pgsql-12/bin/postgresql-12-setup initdb 设置开机启动     如果您希望 PostgreSQL 在操作系统开机启动时自动运行，请执行以下操作：\n# systemctl enable postgresql-12.service 服务器控制     要控制数据库服务，请使用：\n# systemctl \u0026lt;command\u0026gt; postgresql-12.service 其中的  可以为:\n enable : 启用开机启动 start : 启动数据库 stop : 停止数据库 restart : 重启数据库; 主要用于重要参数的变更生效 reload : 在数据库运行过程中更新配置参数  例如，要控制版本 12 的数据库服务，请使用：\n# systemctl enable postgresql-12.service # systemctl start postgresql-12.service 安装后配置调整     修改数据目录下的 pg_hba.conf 文件，以定义从网络中其他主机访问 PostgreSQL 服务器使用的访问控制策略，修改IPv4网络访问控制策略：从 indent 更改为 md5，从本机地址 127.0.0.1 更改为接受所有主机访问请求。找到下面行：\n# IPv4 local connections: host all all 127.0.0.1/32 ident 并将其更改为：\n# IPv4 local connections: host all all 0.0.0.0/0 md5 修改数据目录下的 postgresql.conf 文件，通过取消注释以下参数行并设置参数值为 * 而不是 localhost 来允许来自所有主机的访问连接：\nlisten_addresses = \u0026#39;*\u0026#39; 重启数据库服务以更新配置参数：\n# systemctl restart postgresql-12.service 在生产环境中，还应设置 TLS 安全通信，并且应考虑配置数据复制或基于快照的备份。有关这些配置，请参阅 PostgreSQL 在线文档。\n"},{"id":7,"href":"/zh-cn/usage/configuration/","title":"参数配置","parent":"使用介绍","content":"数据库提供的所有可用服务器配置选项的概述。\n   自动分析 运行时统计信息      自动分析     这些设置控制autoanalyze特性的行为。详情请参考 第 24.1.6 节。注意很多这些设置可以被针对每个表的设置所覆盖，请见存储参数。\n  autoanalyze (boolean)\n控制服务器是否运行自动分析启动器后台进程。默认为开启， 不过要自动分析正常工作还需要启用track_counts。 该参数只能在postgresql.conf文件或服务器命令行中设置， 不过，通过更改表存储参数可以为表禁用自动分析。\n  log_autoanalyze_min_duration (integer)\n如果自动分析运行至少该值所指定的时间量，被自动分析执行的每一个动作都会被日志记录。 将该参数设置为0会记录所有的自动分析动作。 -1（默认值）将禁用对自动分析动作的记录。 如果指定值时没有单位，则以毫秒为单位。 例如，如果你将它设置为250ms，则所有运行250ms或更长时间的自动分析将被记录。此外，当该参数被设置为除-1外的任何值时， 如果一个自动分析动作由于一个锁冲突或者被并发删除的关系而被跳过，将会为此记录一个消息。 开启这个参数对于追踪自动分析活动非常有用。这个参数只能在 postgresql.conf文件或者服务器命令行中设置。但是可以通过更改表的存储参数为个别表覆盖这个设置。\n  autoanalyze_max_workers (integer)\n指定能同时运行的自动分析进程（除了自动分析启动器之外）的最大数量。默认值为3。该参数只能在服务器启动时设置。\n  autoanalyze_naptime (integer)\n指定自动清理在任意给定数据库上运行的最小延迟。在每一轮中后台进程检查数据库并根据需要为数据库中的表发出VACUUM和ANALYZE命令。 如果指定值时没有单位，则以秒为单位。默认值为1分钟（1min）。该参数只能在postgresql.conf文件或在服务器命令行上设置。\n  autoanalyze_base_threshold (integer)\n指定能在一个表上触发ANALYZE的被插入、被更新或被删除元组的最小数量。默认值为50个元组。该参数只能在postgresql.conf文件或在服务器命令中设置。但是对个别表可以通过修改表存储参数来覆盖该设置。\n  autoanalyze_scale_factor (floating point)\n指定一个表尺寸的分数，在决定是否触发ANALYZE时将它加到autoanalyze_base_threshold上。默认值为0.1（表尺寸的10%）。该参数只能在postgresql.conf文件或在服务器命令中设置。但是对个别表可以通过修改表存储参数来覆盖该设置。\n  运行时统计信息     这些参数控制服务器范围的统计数据收集特性。当统计收集被启用时，被产生的数据可以通过pg_stat和pg_statio系统视图族访问。详见第 27 章。\n  track_wait_events (boolean)\n启用有关每个会话中发生的等待事件的信息的收集，包括发生的等待次数和耗时信息。该参数默认开启。注意即使被启用，这些信息也不是对所有用户可见，只有超级用户和拥有报告信息的会话的用户可见，因此它不会表现为一个安全风险。只有超级用户可以更改这个设置。\n "},{"id":8,"href":"/zh-cn/advanced/","title":"高级特性","parent":"欢迎访问红石数据库文档","content":""},{"id":9,"href":"/zh-cn/advanced/plscheme/","title":"PL/Scheme","parent":"高级特性","content":"PL/scheme 是一个用于 Scheme 编程语言的 PostgreSQL 过程语言处理程序。 PL/scheme 在后台使用 Chibi Scheme 作为其 Scheme 解释器。 凭借大量内置的 SRFI 和 Chibi Scheme 的完全 R7RS 兼容性，PL/scheme 可以以 Lisp 风格启动 PostgreSQL 过程。\n特性列表     您可以在下面的列表中找到一些 PL/scheme 支持的功能。\n 即使对于尚未创建的 SQL 数据类型，也可扩展本机类型支持。 还支持域、复杂（即表的行）和伪（记录）类型 IN, INOUT 和 OUT 参数模式功能 每个事务的非易失性（和非 SRF）过程的缓存 Chibi Scheme 支持的任何可用功能（完全符合 R7RS、模块系统扩展、完全访问 POSIX 系统调用、网络支持、多线程、强大的字符串处理、许多内置 SRFI 等等）自然也随 PL/scheme 一起提供  "},{"id":10,"href":"/zh-cn/features/undo/","title":"回滚段","parent":"基础特性","content":"Redrock Postgres 维护事务操作的记录，统称为撤消数据。 Redrock Postgres 使用 undo 来执行以下操作：\n 回滚活跃事务 恢复异常结束的事务 提供读一致性  Redrock Postgres 将 undo 数据存储在数据库中而不是外部日志中。 undo 数据存储在与数据块一样更新的块中，对这些块的更改会产生重做。 通过这种方式，Redrock Postgres 可以高效地访问 undo 数据，而无需读取外部日志。\nundo 数据存储在独立的表空间中。 Redrock Postgres 提供了一种完全自动化的机制，称为自动回滚段管理模式，用于管理回滚段和存储空间。\n回滚段和事务     当事务开始时，数据库将事务绑定（分配）到回滚段，因此绑定到事务表。\n多个活动事务可以同时写入相同的回滚段或不同的回滚段。 例如，事务 T1 和 T2 都可以写入 undo U1，或者 T1 可以写入 U1 而 T2 写入 undo U2。\n事务回滚     当执行 ROLLBACK语句时，数据库使用 undo 记录回滚未提交事务对数据库所做的更改。 在恢复期间，数据库回滚从联机重做日志应用到数据文件的任何未提交的更改。 undo 记录通过在另一个用户正在更改数据的同时为访问数据的用户维护数据的前映像来提供读取一致性。\n"},{"id":11,"href":"/zh-cn/posts/","title":"新闻","parent":"欢迎访问红石数据库文档","content":""},{"id":12,"href":"/zh-cn/posts/initial-release/","title":"Redrock Postgres 版本 12.1-1 发布","parent":"新闻","content":"Redrock 开发团队向您郑重发布 Redrock Postgres 12 版本 12.1-1。\n红石数据库是一款基于 PostgreSQL 的关系型数据库管理系统，PostgreSQL 是由 PostgreSQL 全球开发组织开发的一款开源数据库。红石数据库主要为企业生产环境和多云环境部署而设计。\n欲了解更多信息，请访问网站。\n特性概览:\n 回滚段: 记录日志用于回滚数据的修改和事务 多租户: 在服务器上运行单个数据库实例，并为多个租户提供服务 网络表空间: 通过基于网络的表空间特性，实现数据库的计算和存储分离部署 多线程: 多线程数据库模型使服务器进程能够作为操作系统线程在单独的地址空间中执行 回收站: 提供可存放删除对象的回收站，以防止误操作 DDL事件跟踪: 可跟踪、记录、发布和订阅 DDL 操作  "},{"id":13,"href":"/zh-cn/_includes/","title":"Includes","parent":"欢迎访问红石数据库文档","content":""},{"id":14,"href":"/zh-cn/_includes/include-page/","title":"Include Page","parent":"Includes","content":"Example page include\n Example Shortcode\nShortcode used in an include page.     Head 1 Head 2 Head 3     1 2 3    "},{"id":15,"href":"/zh-cn/tags/","title":"Tags","parent":"欢迎访问红石数据库文档","content":""},{"id":16,"href":"/zh-cn/","title":"欢迎访问红石数据库文档","parent":"","content":"红石数据库是一款基于 PostgreSQL 的关系型数据库管理系统，PostgreSQL是由 PostgreSQL全球开发组织开发的一款开源数据库。 红石数据库主要为企业生产环境和多云环境部署而设计。\n开始上手   特性概览   回滚段   记录日志用于回滚数据的修改和事务  多租户   在服务器上运行单个数据库实例，并为多个租户提供服务  网络表空间   通过基于网络的表空间特性，实现数据库的计算和存储分离部署   多线程   多线程数据库模型使服务器进程能够作为操作系统线程在单独的地址空间中执行  回收站   提供可存放删除对象的回收站，以防止误操作  DDL事件跟踪   可跟踪、记录、发布和订阅 DDL 操作   "}]